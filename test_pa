import tkinter as tk
from tkinter import simpledialog, messagebox
import subprocess
import os
import requests

class MenuGUI:
    def __init__(self, root):
        self.root = root
        self.root.title("Menu")
        self.root.geometry("300x300")

        self.menu_label = tk.Label(self.root, text="Select from the menu:")
        self.menu_label.pack()

        self.menu_options = tk.Listbox(self.root)
        options = [
            "Information Gathering",
            "XSS Tracer",
            "Wordpress",
            "SQL-injection",
            "tesssstte",
            "Generate Report",
            "Exit"
        ]
        for option in options:
            self.menu_options.insert(tk.END, option)
        self.menu_options.pack()

        self.select_button = tk.Button(self.root, text="Select", command=self.handle_selection)
        self.select_button.pack()

    def handle_selection(self):
        selection = self.menu_options.curselection()
        if selection:
            choice = self.menu_options.get(selection)
            if choice == "Information Gathering":
                self.info()
            elif choice == "XSS Tracer":
                self.xsstracer_function()
            elif choice == "Wordpress":
                self.wpscan_scan()
            elif choice == "SQL-injection":
                self.sqlmap()
            elif choice == "tesssstte":
                self.tesssstte_function()
            elif choice == "Generate Report":
                self.generate_report_dialog()
            elif choice == "Exit":
                self.root.destroy()

    def generate_report_dialog(self):
        category = simpledialog.askstring("Generate Report", "Enter report category:")
        if category:
            self.generate_report(category)

    def generate_report(self, category):
        report_filename = f"{category}_report.html"
        with open(report_filename, "w") as report_file:
            report_file.write(f"<html><head><title>{category} Report</title></head><body>")
            report_file.write(f"<h1>{category} Report</h1>")
            report_file.write("<p>This is a dummy report. Replace it with actual content.</p>")
            report_file.write("</body></html>")
        messagebox.showinfo("Report Generated", f"HTML report for {category} has been generated: {report_filename}")



def perform_xss_attack(self):
    url = simpledialog.askstring("XSS Tracer", "Enter the URL to perform XSS attack on:")
    if url:
        # Définir le payload XSS
        payload = "<script>alert('XSS Attack!')</script>"

        # Créer les données du formulaire avec le payload XSS
        form_data = {
            "input_field": payload
        }

        try:
            # Envoyer la requête POST avec les données du formulaire
            response = requests.post(url, data=form_data)

            # Vérifier si la requête a réussi
            if response.status_code == 200:
                print("XSS Attack successful!")
            else:
                print("XSS Attack failed. Status code:", response.status_code)
        except requests.exceptions.RequestException as e:
            print("An error occurred:", e)


    def wpscan_scan(self):
        site_url = simpledialog.askstring("Wordpress", "Enter the Wordpress site URL:")
        if site_url:
            try:
                # Exécute WPScan avec l'URL du site WordPress fournie en argument
                subprocess.run(["wpscan", "--url", site_url, "--enumerate", "u", "--ignore-main-redirect"])
            except FileNotFoundError:
                print("WPScan n'a pas été trouvé sur votre système. Assurez-vous qu'il est installé et accessible dans votre chemin d'exécution.")

    def info(self):
        print("Info function not implemented yet.")

    def sqlmap(self):
        yes = ['Y', 'y', 'yes', 'Yes']
        no = ['N', 'n', 'no', 'No']

        print("usage : python sqlmap.py -h")
        choice8 = input("Continue: y/n :")
        if choice8 in yes:
            subprocess.run(["git", "clone", "https://github.com/padac78/sqlmap", "sqlmap-dev"])
        elif choice8 in no:
            subprocess.run(["clear"])
            self.info()
        elif choice8 == "":
            self.menu()
        else: 
            self.menu()

    def tesssstte_function(self):
        messagebox.showinfo("tesssstte", "tesssstte feature will be implemented soon.")

    def clearScr(self):
        subprocess.run("cls" if os.name == "nt" else "clear", shell=True)

    def menu(self):
        print("Menu function not implemented yet.")

root = tk.Tk()
menu_gui = MenuGUI(root)
root.mainloop()